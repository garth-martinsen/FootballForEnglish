<!--File: layout.ejs -->

<!DOCTYPE html>

<html lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> 
<style>
#game {position: absolute; left: 290px; top: 0px; background-color: lightgreen; width: 1200px; height: 835px;}

.flag {position:"relative"; width: 133px; height: 95px;}
#chile{z-index:0; position: absolute; top: 616px; left: -200px; }

#field {position:absolute; left: 0px; top: 83px;  width:1200px; height:600px;background-color:#90EE90}
.qf { width: 250px; height: 600px; float: left; z-index:2; }
#qfa {position: relative; left: 79px; top: 2px;}
#mid {position: relative; left: -171px; top: 1px; width: 500px; height: 600px; z-index: 0;}
#qfd {position: relative; left: 579px; top: 2px; z-index: 1; }
.goal {width:30px; height:90px; }
#g1{position: absolute; left: 49px; top: 263px; width: 30px; height: 90px; z-index: 2;}
#g2{position: absolute; left: 1078px; top: 266px; width: 30px; height: 90px; z-index: 2;}
#ball { position: absolute;  top: 282px; left:<%=pxpos%>;  width:30px; height:30px; z-index: 3; } 
#leftArrow {position: relative; top: -15px; left: 81px; z-index:<%=leftArrowIsVisible%> }
#rightArrow {position: absolute; left: 535px; top: 100px; z-index: <%=rightArrowIsVisible%>;}
#buttons {position: absolute; top: -126px; font-size: 14em; left: 429px;}
.button {margin:2px;background-color:lightgrey}
#questions {position: absolute; left: 0em; top: 0px; background-color: lightblue; width: 290px;     height: 835px; }
#game_timer {position: absolute;top: 0em; left: .5em;  font-size: xx-large;}
#timer30 {position: relative; top: 35.5em; left: 10.5em;}
#txt {position: relative; left: 4em; top: -1.5em;}
#seconds {max-width: 45px; left: -10px; position: relative; }
#falta {position: absolute; font-size: x-large; width: 50px;    text-align: center; } 
#scores{ font-size: x-large;position: relative; top: 2em;} 
#scoreA {position: relative; left: .3em; background-color: aqua; font-size: .9em; width: 95%;}
#scoreB {position: relative; top: 0.3em; left: .3em; background-color: #FF1800; font-size: .9em; width: 95%}
.scoreInput { position: absolute; left: 4.1em; width: 1em; font-size: 1.1em;text-align:center; }
#QA {position: relative; top: 5em; left:.75em; width:280px; height:80%; font-size: 1.2em; }
.q_A {position:relative; top: 1em; width:90%;font-size:1em;}
#betweenQA {height: 2em; }
.team {font-size:1.2em; vertical-align:top; }
.AnswerLabel {position:relative; top: 1em;}
#showAnswer {position: relative;top: 1.5em; left: 1em; };
H1 { text-align: center; width:1000px; font-size: 2.17em;    margin-left: 200px;}
#title {text-align:center; width:1000px; font-size:2em;}
.scoreBar {height: 30px; width: 100px; }
#leftFlagDiv { position: absolute; left: 80px; top: 731px; width: 133px; height: 95px;}
#leftFlag { position: relative;}
#rightFlagDiv {position: absolute; left: 941px; top: 723px; width: 133px; height: 95px;}
#flagRight { position: relative; width: 133px; height: 95px;}
#leftArrowDiv { position: absolute; left: 514px; top: 102px; width: 120px; z-index: <%=leftArrowIsVisible%> }
#rightArrowDiv { position: absolute; left: 537px; top: 102px; width: 120px;z-index:<%=rightArrowIsVisible%> }
#leftGoalBarDiv { position: absolute; left: -28px; top: 368px; width: 123px; height: 55px; -webkit-transform: rotate(-90deg); z-index: 2;}
#rightGoalBarDiv {position: absolute; left: 1055px;top: 372px; width: 123px; height: 55px; -webkit-transform: rotate( 90deg); z-index: 2; }
.goalBar {height:55px;}
</style>
</head>

<body class="container">
<form id="wholeForm">
<div id="game">
<input type="hidden" name="ballLocation"        value='<%=ballLocation%>'       />
<input type="hidden" name="ballDirection"       value='<%=ballDirection%>'      />
<input type="hidden" name="leftArrowIsVisible"  value='<%=leftArrowIsVisible%>' />
<input type="hidden" name="rightArrowIsVisible" value='<%=rightArrowIsVisible%>'/>
<input type="hidden" name="pxpos"               value='<%=pxpos%>'              />
<input type="hidden" name="leftScoreBar4Game"   value='<%-leftScoreBar4Game%>'  />
<input type="hidden" name="rightScoreBar4Game"  value='<%-rightScoreBar4Game%>' />
<input type="hidden" name="leftArrow4Game"      value='<%-leftArrow4Game%>'     />
<input type="hidden" name="rightArrow4Game"     value='<%-rightArrow4Game%>'    />
<input type="hidden" name="leftFlag4Game"       value='<%-leftFlag4Game%>'      />
<input type="hidden" name="rightFlag4Game"      value='<%-rightFlag4Game%>'     />
<input type="hidden" name="leftCountry"         value='<%-leftCountry%>'        />
<input type="hidden" name="rightCountry"        value='<%-rightCountry%>'       />
<input type="hidden" name="leftGoalBar4Game"   value='<%-leftGoalBar4Game%>'  />
<input type="hidden" name="rightGoalBar4Game"  value='<%-rightGoalBar4Game%>' />

<H1 id='title'><%= name %></H1>
<div id="leftArrowDiv"> </div>
<div id="rightArrowDiv"> </div>
<div id="leftFlagDiv"> </div>
<div id="rightFlagDiv"> </div>
<div id= "leftGoalBarDiv"> </div>
<div id="rightGoalBarDiv"> </div>
<div id="field">
   <img id="qfa" class="qf" src="/images/quarterFieldA.png">
   <img id="mid" src="/images/midfield.png">
   <img id="qfd" class="qf" src="/images/quarterFieldD.png">
   <img id="g1" class:"goal" src="/images/soccerGoal.png">
   <img id="g2" class:"goal" src="/images/soccerGoal.png">
   <img id="ball" src="/images/ball.png" left=pxpos>
</div>
<div id='buttons'>
        <input type="submit" class = "button" id="dir" value="Change Possession" formaction='/possession' formmethod="post" formenctype="application/x-www-form-urlencoded" />
        <input type="submit" class = "button" id="adv" value="Advance Ball" formaction='/advance' formmethod="post" formenctype="application/x-www-form-urlencoded" />
      </div>
<!--  app.ballPositions= ["50px", "264px","560px","862px","1078px" ]; -->

</div>
<div id="questions">
      <div id="game_timer" >Clock:<input type="text" id="falta" name="remaining"  value ='<%=remaining%>' width= 50px readonly > </div>
      <div id="scores" >
       <div id="leftScoreDiv">
        <!--populated by jquery-->
      </div>
      <div id="rightScoreDiv">
        <!--populated by jquery-->
      </div>
     </div>
         <div id="QA" class="contest" >
           <select id="team" name="team" >
             <option value="1"><%-leftCountry%></option>
             <option value="2"><%-rightCountry%></option>
            </select> 
           <select id="mode" name="mode" >
             <option value="1" >Advance</option>
             <option value="2" >Possess</option>
           </select>
           <input  type='submit' class = "button" id="quest" value="Question" formaction='/question' formmethod="post" formenctype="application/x-www-form-urlencoded" /> 
               <textArea id="question_A" name="questionA" class= "q_A" font-size="1.2em" rows="15" cols="10" ><%=questionA%> </textArea>
               <div id="betweenQA">
                <label class="AnswerLabel" >Response </label>
	        <input type='submit' id="showAnswer" class="button"  value="Response" formaction='/answer' formmethod="post" formenctype="application/x-www-form-urlencoded" /> 
               </div>
               <textArea id="answer_A" name="answerA" class= "q_A" rows="5" cols="10"><%=answerA%> </textArea>
        </div>
</div>
</div>
</form> 
<div id='timer30'>
  <button id= "start" class="button" >Timer</button>
  <div id="txt"><input type="text" id="seconds" value=''+30 readonly></div>
</div>
<audio id= "beep" >
  <source src="sounds/beep-07.wav" type="audio/wav">
</audio>
<audio id= "homer" >
  <source id="homer" src="sounds/homer.wav" type="audio/wav">
</audio>

<script>
var beep = document.getElementById("beep"); 
var homer = document.getElementById("homer"); 
var limit = 30; //30 seconds
var start, endMs ;
$(document).ready( function(){
$('#team').val(<%=team%>);
$('#mode').val(<%=mode%>);
$('#leftScoreDiv').html( '<%-leftScoreBar4Game%>  <input type="text"  name="leftScore"  readonly class="scoreInput" value="<%-leftScore%>">');
$('#rightScoreDiv').html('<%-rightScoreBar4Game%>  <input type="text" name="rightScore"  readonly class="scoreInput" value="<%-rightScore%>">');
$('#leftArrowDiv').html( '<%-leftArrow4Game%>');
$('#rightArrowDiv').html('<%-rightArrow4Game%>');
$('#leftFlagDiv').html('<%-leftFlag4Game%>'); 
$('#rightFlagDiv').html('<%-rightFlag4Game%>'); 
setTimeout(function(){
$('#leftGoalBarDiv' ).html('<%-leftGoalBar4Game%>'); 
$('#rightGoalBarDiv').html('<%-rightGoalBar4Game%>');
}, 1000);
var q = $('#question_A').val() ;
if(q.length>1) { 
 setTimeout(function(){
//   alert('Question length is: ' + q.length)
   $("#start").trigger("click"); 
}, 2000);
}
$(document).keyup( function(event){
console.log('Key was: ' + event.which)
if(73 === event.which) { 
//    alert('Pressed key for : Show Answer'  );
 $("#showAnswer").trigger( "click" );
}
if(74 === event.which) { 
//    alert('Pressed key for : Next Question'  );
 $("#quest").trigger( "click" );
}
if(75 === event.which) { 
//   alert('Pressed key for : Start question timer'  );
 $("#start").trigger("click");
}
if(76 === event.which) { 
//    alert('Pressed key for : Advance ball'  );
 $("#adv").trigger("click");
}
if(186  === event.which) { 
//   alert('Pressed key for : Change Possession' )
 $("#dir").trigger("click");
}
});
$('#start').on( "click", function() {
  console.log( 'Clicked start QuestionTimer.');
 init();
});
var init=function(){
start= new Date();
endMs = start.getTime() + 30000;
oneTick();
}
var oneTick=function () {
    s= Math.floor((endMs - new Date().getTime())/1000);
    s = checkTime(s);
    $('#seconds').val(s);
    console.log('time: ' + s);
    var t = setTimeout(function(){ 
       if(s> 0){
         oneTick();} 
       else{
       beep.play();
       s='Expired!';
       setTimeout(function(){
          homer.play();}, 1000);
       $('#seconds').val(s); } }, 1000);
}

// add a zero in front of numbers<10
function checkTime(i) {
    if (i < 10) {
        i = "0" + i;
    }
    return i;
}
});
  </script>
</body>
</html>
