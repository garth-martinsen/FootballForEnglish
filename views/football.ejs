<!--File: layout.ejs -->

<!DOCTYPE html>

<html lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> 
<style>
#game {position: absolute; left: 290px; top: 0px; background-color: lightgreen; width: 1200px; height: 835px;}
.flag {position:"absolute"; left:110px; top:244px;width: 130px; height: 95px;  }
#chile{z-index:0; position: absolute; top: 616px; left: -200px; }
#brasil{z-index:0; position:absolute;top: 616px; left: 115px;} 
#argentina {z-index:0; position:absolute;top:  616px; left: 400px;}
#left {z-index:1}
#right {z-index:1}
#field {position:absolute; left: 350px; top: 83px; background-color:green }
.qf { width: 250px; height: 600px; float: left; z-index:2; }
#qfa {position: absolute; left: -320px;}
#mid {position:absolute; left:-70px; width:500px; height:600px; z-index:1}
#qfd {position: absolute; left: 427px;z-index: 1; }
.goal {width:30px; height:50px; width:30px; height:90px; }
#g1{position: absolute; left: -350px; top: 259px; width:30px; height:90px;  z-index:2; }
#blueGoal {background-color: cyan; position: absolute; left: -359px; top:249px; width: 40px;  height: 110px; z-index:1}
#g2{position: relative; left: 678px; top: 260px; width:30px; height:90px;  z-index:1; }
#redGoal { height: 110px;width: 40px;   position: absolute; left: 678px; top:250px; background-color: red; z-index:0}
#ball { position: absolute;  top: 282px; left:<%=pxpos%>;  width:30px; height:30px; z-index: 3; } 
#leftArrow {position: relative; top: -15px; left: 81px; z-index:<%=leftArrowIsVisible%> }
#rightArrow {position: relative; top: -15px; left: -11px; z-index: <%=rightArrowIsVisible%>;}
#buttons {position: absolute; top: -126px; font-size: 14em; left: 379px; }
.button {margin:2px;background-color:lightgrey}
#questions {position: absolute; left: 0em; top: 0px; background-color: lightblue; width: 290px;     height: 835px; }
#timer {position: absolute;top: 0em; left: .5em;  font-size: xx-large;}
#timer30 {position:absolute; top: 536px; left: 11em;}
#txt {position: relative; left: 4em; top: -1.5em;}
#seconds {max-width: 45px; left: -10px; position: relative; }
#falta {position: absolute; font-size: x-large; width: 50px;    text-align: center; } 
#scores{ font-size: x-large;position: relative; top: 2em;} 
#scoreA {position: relative; left: .3em; background-color: aqua; font-size: .9em; width: 95%;}
#scoreB {position: relative; top: 0.3em; left: .3em; background-color: #FF1800; font-size: .9em; width: 95%}
.scoreInput { position: absolute; left: 4.1em; width: 1em; font-size: 1.1em;text-align:center; }
#QA {position: relative; top: 4em; left:.75em; width:280px; height:80%; font-size: 1.2em; }
.q_A {position:relative; top: 1em; width:90%;font-size:1em;}
#betweenQA {height: 2em; }
.team {font-size:1.2em; vertical-align:top; }
.AnswerLabel {position:relative; top: 1em;}
#showAnswer {position: relative;top: 1.5em; left: 1em; };
H1 { text-align: center; width:1000px; font-size: 2.17em;    margin-left: 200px;}
#title {text-align:center; width:1000px; font-size:2em;}
</style>
</head>

<body class="container">
<form id="wholeForm">
<div id="game">
<input type="hidden" name="ballLocation" value=<%=ballLocation%>/>
<input type="hidden" name="ballDirection" value=<%=ballDirection%>/>
<input type="hidden" name="leftArrowIsVisible" value=<%=leftArrowIsVisible%>/>
<input type="hidden" name="rightArrowIsVisible" value=<%=rightArrowIsVisible%>/>
<input type="hidden" name="remaining" value=<%=remaining%>/>
<input type="hidden" name="pxpos" value='<%=pxpos%>'/>
 <H1 id='title'><%= name %></H1>
<div id="field" >
         <img id="qfa" class="qf" src="/images/quarterFieldA.png">
         <img id="mid" src="/images/midfield.png">
         <img id="qfd" class="qf" src="/images/quarterFieldD.png">
         <img id="g1" class:"goal" src="/images/soccerGoal.png">
         <img id="g2" class:"goal" src="/images/soccerGoal.png">
         <img id="ball" src="/images/ball.png" left=pxpos>
         <img id="leftArrow" src="/images/ArrowLeft.png" >
         <img id="rightArrow" src="/images/ArrowRight.png" >
         <img id="chile" class="flag" src="/images/BanderaChile.png" >
         <img id="argentina" class="flag" src="/images/BanderaArgentina.png" >
         <img id="brasil" class="flag" src="/images/BanderaBrasil.png" >
         <img id="redGoal">
         <img id="blueGoal">
</div>
      <div id='buttons'>
        <input type="submit" class = "button" id="dir" value="Change Possession" formaction='/possession' formmethod="post" formenctype="application/x-www-form-urlencoded" />
        <input type="submit" class = "button" id="adv" value="Advance Ball" formaction='/advance' formmethod="post" formenctype="application/x-www-form-urlencoded" />
      </div>
</div>
<div id="questions">
      <div id="timer" name="remaining" >Clock:<input type="text" id="falta" value =<%=remaining%> width= 50px readonly ></div>
      <div id="scores" >
       <div id="scoreA">
          Argentina <input type="text" name="scoreA"  readonly class="scoreInput" value='<%=scoreA%>'>
      </div>
      <div id="scoreB">
          Chile <input type="text" name="scoreB"  readonly class="scoreInput" value='<%=scoreB%>'>
      </div>
     </div>
         <div id="QA" class="contest" >
           <select id="team" name="team" >
             <option value=1>Argentina</option>
             <option value=2>Brazil</option>Chile
             <option value=3>Chile</option>
            </select> 
           <select id="mode" name="mode" >
             <option value=1>Advance</option>
             <option value=2>Possess</option>
           </select>
           <input  type='submit' class = "button" id="quest" value="Question" formaction='/question' formmethod="post" formenctype="application/x-www-form-urlencoded" /> 
               <textArea id="question_A" class= "q_A" font-size="1.2em" rows="15" cols="10" ><%=questionA%> </textArea>
               <div id="betweenQA">
                <label class="AnswerLabel" >Response </label>
	        <input type='submit' id="showAnswer" class="button"  value="Response" formaction='/answer' formmethod="post" formenctype="application/x-www-form-urlencoded" /> 
               </div>
               <textArea id="answer_A" class= "q_A" rows="5" cols="10"><%=answerA%> </textArea>
        </div>
</div>
</div>
</form> <!--wholeForm -->
<div id='timer30'>
  <button id= "start" class="button" >Timer</button>
  <div id="txt"><input type="text" id="seconds" value=''+30 readonly></div>
</div>
<audio id= "beep" >
  <source src="sounds/beep-07.wav" type="audio/wav">
</audio>
<audio id= "homer" >
  <source id="homer" src="sounds/homer.wav" type="audio/wav">
</audio>
<script>
//var ballPositions= {"-349px","-116px","163px","454px","676px" };
var aud = document.getElementById("beep"); 
var homer = document.getElementById("homer"); 
var limit = 30; //30 seconds
var start, endMs, enabled;
$(document).ready( function(){
$('#team').val(<%=team%>);
$('#mode').val(<%=mode%>);
var q = $('#question_A').val() ;
if(q.length>1) { 
 setTimeout(function(){
//   alert('Question length is: ' + q.length)
   $("#start").trigger("click"); 
}, 2000);
}
$(document).keyup( function(event){
console.log('Key was: ' + event.which)
if(73 === event.which) { 
//    alert('Pressed key for : Next Question'  );
 $("#showAnswer").trigger( "click" );
}
if(74 === event.which) { 
//    alert('Pressed key for : Next Question'  );
 $("#quest").trigger( "click" );
}
if(75 === event.which) { 
//   alert('Pressed key for : Start question timer'  );
 $("#start").trigger("click");
}
if(76 === event.which) { 
//    alert('Pressed key for : Advance ball'  );
 $("#adv").trigger("click");
}
if(186  === event.which) { 
//   alert('Pressed key for : Change Possession' )
 $("#dir").trigger("click");
}
});
$('#start').on( "click", function() {
  console.log( 'Clicked start timer.');
 init();
});
var init=function(){
start= new Date();
endMs = start.getTime() + 30000;
$('#seconds').val(30);
oneTick();
}
var oneTick=function () {
    s= Math.floor((endMs - new Date().getTime())/1000);
    s = checkTime(s);
    $('#seconds').val(s);
    console.log('time: ' + s);
    var t = setTimeout(function(){ 
       if(s> 0){
         oneTick();} 
       else{
       aud.play();
       s='Expired!';
       setTimeout(function(){
          homer.play();}, 2000);
       $('#seconds').val(s); } }, 1000);
}

// add a zero in front of numbers<10
function checkTime(i) {
    if (i < 10) {
        i = "0" + i;
    }
    return i;
}
});
  </script>
</body>
</html>
